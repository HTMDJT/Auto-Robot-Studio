<!--
 * @Author: Wan Peng 102275086+HTMDJT@users.noreply.github.com
 * @Date: 2024-12-10 13:08:20
 * @LastEditors: Wan Peng 102275086+HTMDJT@users.noreply.github.com
 * @LastEditTime: 2024-12-10 13:11:04
 * @FilePath: \Auto-Robot-Studio\Motor Control\3508\README.md
 * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE
-->
# README

## 一、程序架构

| **文件名**  | **主要功能**                    | **主要方法**          | **性质**               |
| ----------- | ----------------------------- | --------------------- | ---------------------- |
| `bsp_can.c/h` | 完成 CAN 接收配置/CAN 接收中断回调 | `CAN_Init_and_start()` | 底层库，仅被调用       |
| `pid.c/h`     | 基本数学函数/基础运算；PID 运算  | `general_pid_cal()`    | 底层库，仅被调用       |
| `motor.c/h`   | 针对 M3508 设置电流的控制       | `M3508_set_current()`  | 封装层，辅佐应用层     |

---

## 二、备注

- 目前的 `motor.c/h` 仅针对 **C620 电调**。  
- 文件编码格式采用 **UTF-8**，==请阅读/修改本程序时务必使用 UTF-8 编码格式==。  
- 本程序已根据**电控组代码规范**进行了规整和注释。  

### 1. 当前问题
`motor.c/h` 是通过设置电流到数组，并将数组通过 CAN 发送出去来实现对 **C620 电调** 的控制。  

- 其余程序已结合 **24 年 R1 机器人代码** 和 **DJI C620 电调例程** 进行了对比与核对。  

### 2. 编程建议
- **整合函数，提升代码可读性**  
  在编程时，尽可能将多个相似的函数进行整合。  
  例如，原 R1 代码中的 PID 相关函数有 4 个，但本质上都是 `pid_cal`。  
  不同的函数仅在对 `pid_t` 结构体中的 `err` 进行限制。  
  > **改进思路：**  
  - 采用**开关选择的思想**，将这 4 个函数合并为 1 个。  
  - 通过传入参数 `mode` 来选择不同的运算模式，简化函数调用逻辑。  
  - 这样可以**保持内核不变**，其余的特殊逻辑仅作为附加功能添加在内核上，提升了**可读性和可维护性**。  

---

**万鹏 韩宝龙 编著** 2024年11月27日 11:03:52
